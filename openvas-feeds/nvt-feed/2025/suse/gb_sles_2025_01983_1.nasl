# SPDX-FileCopyrightText: 2025 Greenbone AG
# Some text descriptions might be excerpted from (a) referenced
# source(s), and are Copyright (C) by the respective right holder(s).
#
# SPDX-License-Identifier: GPL-2.0-only

if(description)
{
  script_oid("1.3.6.1.4.1.25623.1.1.4.2025.01983.1");
  script_cve_id("CVE-2020-36791", "CVE-2021-20320", "CVE-2021-4159", "CVE-2021-47170", "CVE-2021-47670", "CVE-2022-3564", "CVE-2022-48875", "CVE-2022-49139", "CVE-2022-49145", "CVE-2022-49168", "CVE-2022-49190", "CVE-2022-49212", "CVE-2022-49216", "CVE-2022-49235", "CVE-2022-49248", "CVE-2022-49253", "CVE-2022-49320", "CVE-2022-49326", "CVE-2022-49371", "CVE-2022-49382", "CVE-2022-49396", "CVE-2022-49420", "CVE-2022-49441", "CVE-2022-49445", "CVE-2022-49460", "CVE-2022-49467", "CVE-2022-49474", "CVE-2022-49491", "CVE-2022-49503", "CVE-2022-49592", "CVE-2022-49625", "CVE-2022-49635", "CVE-2022-49652", "CVE-2022-49715", "CVE-2022-49728", "CVE-2022-49729", "CVE-2022-49751", "CVE-2022-49761", "CVE-2022-49769", "CVE-2022-49771", "CVE-2022-49772", "CVE-2022-49775", "CVE-2022-49776", "CVE-2022-49787", "CVE-2022-49788", "CVE-2022-49789", "CVE-2022-49813", "CVE-2022-49818", "CVE-2022-49821", "CVE-2022-49822", "CVE-2022-49826", "CVE-2022-49829", "CVE-2022-49832", "CVE-2022-49835", "CVE-2022-49840", "CVE-2022-49842", "CVE-2022-49846", "CVE-2022-49853", "CVE-2022-49861", "CVE-2022-49862", "CVE-2022-49865", "CVE-2022-49871", "CVE-2022-49872", "CVE-2022-49874", "CVE-2022-49877", "CVE-2022-49880", "CVE-2022-49889", "CVE-2022-49892", "CVE-2022-49898", "CVE-2022-49906", "CVE-2022-49907", "CVE-2022-49909", "CVE-2022-49910", "CVE-2022-49913", "CVE-2022-49914", "CVE-2022-49915", "CVE-2022-49922", "CVE-2022-49923", "CVE-2022-49924", "CVE-2022-49925", "CVE-2022-49927", "CVE-2022-49931", "CVE-2023-1074", "CVE-2023-1989", "CVE-2023-1990", "CVE-2023-52868", "CVE-2023-52975", "CVE-2023-52988", "CVE-2023-52989", "CVE-2023-52993", "CVE-2023-53039", "CVE-2023-53041", "CVE-2023-53044", "CVE-2023-53045", "CVE-2023-53051", "CVE-2023-53056", "CVE-2023-53060", "CVE-2023-53062", "CVE-2023-53066", "CVE-2023-53068", "CVE-2023-53075", "CVE-2023-53078", "CVE-2023-53079", "CVE-2023-53080", "CVE-2023-53094", "CVE-2023-53100", "CVE-2023-53101", "CVE-2023-53103", "CVE-2023-53106", "CVE-2023-53108", "CVE-2023-53109", "CVE-2023-53114", "CVE-2023-53119", "CVE-2023-53121", "CVE-2023-53124", "CVE-2023-53125", "CVE-2023-53131", "CVE-2023-53139", "CVE-2023-53140", "CVE-2023-53141", "CVE-2023-53145", "CVE-2024-26740", "CVE-2024-26804", "CVE-2024-27010", "CVE-2024-45021", "CVE-2024-46751", "CVE-2024-46752", "CVE-2024-50106", "CVE-2024-53168", "CVE-2024-56633", "CVE-2024-56779", "CVE-2025-21648", "CVE-2025-21702", "CVE-2025-21704", "CVE-2025-21787", "CVE-2025-21814", "CVE-2025-21969", "CVE-2025-22021", "CVE-2025-22025", "CVE-2025-22027", "CVE-2025-22050", "CVE-2025-22058", "CVE-2025-22060", "CVE-2025-22063", "CVE-2025-22104", "CVE-2025-23136", "CVE-2025-23150", "CVE-2025-23161", "CVE-2025-37749", "CVE-2025-37752", "CVE-2025-37780", "CVE-2025-37782", "CVE-2025-37789", "CVE-2025-37794", "CVE-2025-37796", "CVE-2025-37797", "CVE-2025-37798", "CVE-2025-37823", "CVE-2025-37833", "CVE-2025-37852", "CVE-2025-37871", "CVE-2025-37879", "CVE-2025-37932", "CVE-2025-37948", "CVE-2025-37949", "CVE-2025-37953", "CVE-2025-37963", "CVE-2025-37989", "CVE-2025-38637");
  script_tag(name:"creation_date", value:"2025-06-19 04:15:13 +0000 (Thu, 19 Jun 2025)");
  script_version("2025-08-15T15:42:26+0000");
  script_tag(name:"last_modification", value:"2025-08-15 15:42:26 +0000 (Fri, 15 Aug 2025)");
  script_tag(name:"cvss_base", value:"2.1");
  script_tag(name:"cvss_base_vector", value:"AV:L/AC:L/Au:N/C:P/I:N/A:N");
  script_tag(name:"severity_vector", value:"CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H");
  script_tag(name:"severity_origin", value:"NVD");
  script_tag(name:"severity_date", value:"2025-04-14 12:36:32 +0000 (Mon, 14 Apr 2025)");

  script_name("SUSE: Security Advisory (SUSE-SU-2025:01983-1)");
  script_category(ACT_GATHER_INFO);
  script_copyright("Copyright (C) 2025 Greenbone AG");
  script_family("SuSE Local Security Checks");
  script_dependencies("gather-package-list.nasl");
  script_mandatory_keys("ssh/login/suse_sles", "ssh/login/rpms", re:"ssh/login/release=(SLES12\.0SP5)");

  script_xref(name:"Advisory-ID", value:"SUSE-SU-2025:01983-1");
  script_xref(name:"URL", value:"https://www.suse.com/support/update/announcement/2025/suse-su-202501983-1.html");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1184350");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1190317");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1190601");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1194227");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1206073");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1206649");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1206677");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1206887");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1209292");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1209556");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1209684");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1210336");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1210337");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1211466");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1213012");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1213013");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1218752");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1222004");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1222563");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1222629");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1223720");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1225044");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1229516");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1230434");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1230786");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1230794");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1232504");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1232649");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1232882");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1234887");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1235485");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1235632");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1236142");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1237312");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1237571");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238019");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238032");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238071");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238109");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238130");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238162");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238263");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238284");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238289");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238306");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238311");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238331");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238333");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238338");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238394");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238411");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238420");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238473");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238539");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238546");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238646");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238774");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238806");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238815");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238818");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238868");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238871");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238887");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1238892");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1239060");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1239111");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240254");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240261");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240266");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240293");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240297");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240322");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1240784");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241282");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241332");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241351");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241357");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241361");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241369");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241407");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241441");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241526");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241550");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1241657");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242147");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242154");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242165");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242215");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242218");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242219");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242225");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242227");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242228");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242231");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242239");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242241");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242245");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242248");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242284");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242285");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242287");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242288");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242352");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242353");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242361");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242362");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242366");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242370");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242371");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242372");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242377");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242378");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242382");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242385");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242394");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242398");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242405");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242408");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242409");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242414");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242416");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242417");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242422");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242426");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242427");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242440");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242447");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242449");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242450");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242452");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242453");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242455");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242464");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242470");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242472");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242478");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242483");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242484");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242497");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242504");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242513");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242527");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242542");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242544");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242549");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242558");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242566");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242570");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242580");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242594");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242686");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242688");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242691");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242716");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242727");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242734");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242745");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242747");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242755");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242756");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242759");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242762");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242765");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242770");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242778");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242786");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242790");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242791");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242792");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242835");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242859");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242868");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242924");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1242949");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243047");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243074");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243077");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243511");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243541");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243543");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243627");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243649");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243660");
  script_xref(name:"URL", value:"https://bugzilla.suse.com/1243919");
  script_xref(name:"URL", value:"https://lists.suse.com/pipermail/sle-updates/2025-June/040323.html");

  script_tag(name:"summary", value:"The remote host is missing an update for the 'Linux Kernel' package(s) announced via the SUSE-SU-2025:01983-1 advisory.");

  script_tag(name:"vuldetect", value:"Checks if a vulnerable package version is present on the target host.");

  script_tag(name:"insight", value:"The SUSE Linux Enterprise 12 SP5 kernel was updated to receive various security bugfixes.


The following security bugs were fixed:

- CVE-2021-47670: can: peak_usb: fix use after free bugs (bsc#1241407).
- CVE-2022-49139: Bluetooth: fix null ptr deref on hci_sync_conn_complete_evt (bsc#1238032).
- CVE-2022-49145: ACPI: CPPC: Avoid out of bounds access when parsing _CPC data (bsc#1238162).
- CVE-2022-49168: btrfs: do not clean up repair bio if submit fails (bsc#1238109).
- CVE-2022-49190: kernel/resource: fix kfree() of bootmem memory again (bsc#1238130).
- CVE-2022-49212: mtd: rawnand: atmel: fix refcount issue in atmel_nand_controller_init (bsc#1238331).
- CVE-2022-49216: drm/tegra: Fix reference leak in tegra_dsi_ganged_probe (bsc#1238338).
- CVE-2022-49235: ath9k_htc: fix uninit value bugs (bsc#1238333).
- CVE-2022-49248: ALSA: firewire-lib: fix uninitialized flag for AV/C deferred transaction (bsc#1238284).
- CVE-2022-49253: media: usb: go7007: s2250-board: fix leak in probe() (bsc#1238420).
- CVE-2022-49320: dmaengine: zynqmp_dma: In struct zynqmp_dma_chan fix desc_size data type (bsc#1238394).
- CVE-2022-49326: rtl818x: Prevent using not initialized queues (bsc#1238646).
- CVE-2022-49371: driver core: fix deadlock in __device_attach (bsc#1238546).
- CVE-2022-49382: soc: rockchip: Fix refcount leak in rockchip_grf_init (bsc#1238306).
- CVE-2022-49396: phy: qcom-qmp: fix reset-controller leak on probe errors (bsc#1238289).
- CVE-2022-49420: net: annotate races around sk->sk_bound_dev_if (bsc#1238887).
- CVE-2022-49441: tty: fix deadlock caused by calling printk() under tty_port->lock (bsc#1238263).
- CVE-2022-49445: pinctrl: renesas: core: Fix possible null-ptr-deref in sh_pfc_map_resources() (bsc#1238019).
- CVE-2022-49460: PM / devfreq: rk3399_dmc: Disable edev on remove() (bsc#1238892).
- CVE-2022-49467: drm: msm: fix possible memory leak in mdp5_crtc_cursor_set() (bsc#1238815).
- CVE-2022-49474: Bluetooth: fix dangling sco_conn and use-after-free in sco_sock_timeout (bsc#1238071).
- CVE-2022-49491: drm/rockchip: vop: fix possible null-ptr-deref in vop_bind() (bsc#1238539).
- CVE-2022-49503: ath9k_htc: fix potential out of bounds access with invalid rxstatus->rs_keyix (bsc#1238868).
- CVE-2022-49592: net: stmmac: fix dma queue left shift overflow issue (bsc#1238311).
- CVE-2022-49625: sfc: fix kernel panic when creating VF (bsc#1238411).
- CVE-2022-49635: drm/i915/selftests: fix subtraction overflow bug (bsc#1238806).
- CVE-2022-49652: dmaengine: ti: Fix refcount leak in ti_dra7_xbar_route_allocate (bsc#1238871).
- CVE-2022-49715: irqchip/gic-v3: Fix refcount leak in gic_populate_ppi_partitions (bsc#1238818).
- CVE-2022-49728: kABI workaround for changeing the variable length type to size_t (bsc#1239111).
- CVE-2022-49729: nfc: nfcmrvl: Fix memory leak in nfcmrvl_play_deferred (bsc#1239060).
- CVE-2022-49751: w1: fix WARNING after calling w1_process() ... [Please see the references for more information on the vulnerabilities]");

  script_tag(name:"affected", value:"'Linux Kernel' package(s) on SUSE Linux Enterprise Server 12-SP5.");

  script_tag(name:"solution", value:"Please install the updated package(s).");

  script_tag(name:"solution_type", value:"VendorFix");
  script_tag(name:"qod_type", value:"package");

  exit(0);
}

include("revisions-lib.inc");
include("pkg-lib-rpm.inc");

release = rpm_get_ssh_release();
if(!release)
  exit(0);

res = "";
report = "";

if(release == "SLES12.0SP5") {

  if(!isnull(res = isrpmvuln(pkg:"cluster-md-kmp-default", rpm:"cluster-md-kmp-default~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"dlm-kmp-default", rpm:"dlm-kmp-default~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"gfs2-kmp-default", rpm:"gfs2-kmp-default~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-default", rpm:"kernel-default~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-default-base", rpm:"kernel-default-base~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-default-devel", rpm:"kernel-default-devel~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-default-man", rpm:"kernel-default-man~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-devel", rpm:"kernel-devel~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-macros", rpm:"kernel-macros~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-source", rpm:"kernel-source~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"kernel-syms", rpm:"kernel-syms~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(!isnull(res = isrpmvuln(pkg:"ocfs2-kmp-default", rpm:"ocfs2-kmp-default~4.12.14~122.261.1", rls:"SLES12.0SP5"))) {
    report += res;
  }

  if(report != "") {
    security_message(data:report);
  } else if(__pkg_match) {
    exit(99);
  }
  exit(0);
}

exit(0);
